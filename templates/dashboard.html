{% extends 'base.html' %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container-fluid px-4">

  <!-- Dashboard Title -->
  <h2 class="text-primary fw-bold mb-4 d-flex align-items-center">
    <i class="bi bi-speedometer2 me-2"></i> Inventory Dashboard
  </h2>

  <!-- Stats Section -->
  <div class="row g-4">

    <!-- Total Products -->
    <div class="col-md-4">
      <div class="card shadow-lg border-0 rounded-4 p-4 text-center">
        <div class="icon-circle mb-3 bg-gradient-primary">
          <i class="bi bi-box-seam"></i>
        </div>
        <h6 class="text-muted">TOTAL PRODUCTS</h6>
        <h2 class="fw-bold text-dark">{{ total_products }}</h2>
      </div>
    </div>

    <!-- Total Quantity -->
    <div class="col-md-4">
      <div class="card shadow-lg border-0 rounded-4 p-4 text-center">
        <div class="icon-circle mb-3 bg-gradient-success">
          <i class="bi bi-stack"></i>
        </div>
        <h6 class="text-muted">TOTAL QUANTITY</h6>
        <h2 class="fw-bold text-dark">{{ total_quantity }}</h2>
      </div>
    </div>

    <!-- Total Value -->
    <div class="col-md-4">
      <div class="card shadow-lg border-0 rounded-4 p-4 text-center">
        <div class="icon-circle mb-3 bg-gradient-warning">
          <i class="bi bi-cash-stack"></i>
        </div>
        <h6 class="text-muted">TOTAL INVENTORY VALUE</h6>
        <h2 class="fw-bold text-success">PKR {{ "{:,.0f}".format(total_value) }}</h2>
      </div>
    </div>
  </div>

  <!-- Chart Section -->
  <div class="card mt-5 shadow-lg border-0 rounded-4">
    <div class="card-body p-4">
      <h4 class="fw-semibold text-secondary mb-3">
        <i class="bi bi-bar-chart-fill me-2"></i> Product Quantity Overview
      </h4>
      <canvas id="inventoryChart" height="130"></canvas>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="mt-5 d-flex justify-content-center gap-3">
    <a href="/" class="btn btn-primary btn-lg px-4 shadow-sm">
      <i class="bi bi-box"></i> Manage Products
    </a>
    <a href="/add" class="btn btn-success btn-lg px-4 shadow-sm">
      <i class="bi bi-plus-circle"></i> Add New Product
    </a>
    <a href="/sales-report" class="btn btn-outline-secondary btn-lg px-4 shadow-sm">
      <i class="bi bi-graph-up"></i> View Sales Report
    </a>
  </div>

</div>

<style>
  .icon-circle {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    font-size: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
  }
  .bg-gradient-primary {
    background: linear-gradient(135deg, #0d6efd, #418dff);
  }
  .bg-gradient-success {
    background: linear-gradient(135deg, #28a745, #58cf73);
  }
  .bg-gradient-warning {
    background: linear-gradient(135deg, #ffc107, #ffda62);
  }
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx = document.getElementById('inventoryChart').getContext('2d');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: {{ names | safe }},
      datasets: [{
        label: 'Stock Quantity',
        data: {{ quantities | safe }},
        backgroundColor: 'rgba(13, 110, 253, 0.65)',
        borderColor: '#0d6efd',
        borderWidth: 2,
        borderRadius: 8
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false }},
      scales: {
        y: {
          beginAtZero: true,
          ticks: { stepSize: 1 }
        }
      }
    }
  });
</script>
{% endblock %}
